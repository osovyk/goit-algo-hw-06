import networkx as nx
import scipy as sp
import matplotlib.pyplot as plt

metro_edges_m1 = [
    ("Академмістечко", "Житомирська", 2),
    ("Житомирська", "Святошин", 3),
    ("Святошин", "Нивки", 2),
    ("Нивки", "Берестейська", 1),
    ("Берестейська", "Шулявська", 3),
    ("Шулявська", "Політехнічний інститут", 2),
    ("Політехнічний інститут", "Вокзальна", 4),
    ("Вокзальна", "Університет", 1),
    ("Університет", "Театральна", 2),
    ("Театральна", "Хрещатик", 2),
    ("Хрещатик", "Арсенальна", 3),
    ("Арсенальна", "Дніпро", 2),
    ("Дніпро", "Гідропарк", 2),
    ("Гідропарк", "Лівобережна", 3),
    ("Лівобережна", "Дарниця", 2),
    ("Дарниця", "Чернігівська", 2),
    ("Чернігівська", "Лісова", 2)
]

metro_edges_m2 = [
    ("Героїв Дніпра", "Мінська", 2),
    ("Мінська", "Оболонь", 2),
    ("Оболонь", "Почайна", 2),
    ("Почайна", "Тараса Шевченка", 3),
    ("Тараса Шевченка", "Контрактова площа", 2),
    ("Контрактова площа", "Поштова площа", 2),
    ("Поштова площа", "Майдан Незалежності", 2),
    ("Майдан Незалежності", "Площа Українських героїв", 2),
    ("Площа Українських героїв", "Олімпійська", 2),
    ("Олімпійська", "Палац Україна", 1),
    ("Палац Україна", "Либідська", 2),
    ("Либідська", "Деміївська", 2),
    ("Деміївська", "Голосіївська", 1),
    ("Голосіївська", "Васильківська", 3),
    ("Васильківська", "Виставковий центр", 3),
    ("Виставковий центр", "Іподром", 2),
    ("Іподром", "Теремки", 2)
]

metro_edges_m3 = [
    ("Сирець", "Дорогожичі", 2),
    ("Дорогожичі", "Лук`янівська", 4),
    ("Лук`янівська", "Золоті ворота", 5),
    ("Золоті ворота", "Палац спорту", 2),
    ("Палац спорту", "Кловська", 2),
    ("Кловська", "Печерська", 2),
    ("Печерська", "Звіринецька", 2),
    ("Звіринецька", "Видубичі", 3),
    ("Видубичі", "Славутич", 5),
    ("Славутич", "Осокорки", 2),
    ("Осокорки", "Позняки", 3),
    ("Позняки", "Харківська", 3),
    ("Харківська", "Вирлиця", 3),
    ("Вирлиця", "Бориспільська", 3),
    ("Бориспільська", "Червоний Хутір", 2)
]

electric_edges = [
    ("Е_Святошин", "Е_Берестейська", 8),
    ("Е_Берестейська", "Е_Сирець", 4),
    ("Е_Сирець", "Е_Пріорка", 5),
    ("Е_Пріорка", "Е_Куренівка", 4),
    ("Е_Куренівка", "Е_Почайна", 3),
    ("Е_Почайна", "Е_Райдужний", 11),
    ("Е_Райдужний", "Е_Воскресенка", 2),
    ("Е_Воскресенка", "Е_Микільська Слобідка", 3),
    ("Е_Микільська Слобідка", "Е_Лівобережна", 3),
    ("Е_Лівобережна", "Е_Русанівка", 4),
    ("Е_Русанівка", "Е_Дарниця", 11),
    ("Е_Дарниця", "Е_Березняки", 6),
    ("Е_Березняки", "Е_Видубичі", 7),
    ("Е_Видубичі", "Е_Київ-Деміївський", 3),
    ("Е_Київ-Деміївський", "Е_Протасів Яр", 5),
    ("Е_Протасів Яр", "Е_Вокзальна", 6),
    ("Е_Вокзальна", "Е_Караваєві Дачі", 6),
    ("Е_Караваєві Дачі", "Е_Київ-Волинський", 6),
    ("Е_Київ-Волинський", "Е_Борщагівка", 7),
]

# Пересадки між лініями метро
metro_transfers = [
    ("Театральна", "Золоті ворота", 2),
    ("Майдан Незалежності", "Хрещатик", 2),
    ("Палац спорту", "Площа Українських героїв", 2)
]

# Пересадки між метро і міською електричкою (узгоджені назви)
metro_to_electric_transfers = [
    ("Лівобережна", "Е_Лівобережна", 5),
    ("Видубичі", "Е_Видубичі", 1),
    ("Вокзальна", "Е_Вокзальна", 2),
    ("Берестейська", "Е_Берестейська", 5),
    ("Сирець", "Е_Сирець", 1),
    ("Почайна", "Е_Почайна", 1),
]

# Створюємо граф
G_metro = nx.Graph()

# Додаємо ребра для всіх ліній метро та міської електрички
G_metro.add_weighted_edges_from(metro_edges_m1)
G_metro.add_weighted_edges_from(metro_edges_m2)
G_metro.add_weighted_edges_from(metro_edges_m3)
G_metro.add_weighted_edges_from(electric_edges)
G_metro.add_weighted_edges_from(metro_transfers)
G_metro.add_weighted_edges_from(metro_to_electric_transfers)

# Візуалізація
# pos = nx.spring_layout(G_metro)
pos = nx.kamada_kawai_layout(G_metro)
# pos = nx.circular_layout(G_metro)
# pos = nx.shell_layout(G_metro)

plt.figure(figsize=(20, 15))

# Малюємо кожну лінію метро різними кольорами
nx.draw_networkx_edges(G_metro, pos, edgelist=metro_edges_m1, edge_color="red", width=1.5, alpha=0.7)
nx.draw_networkx_edges(G_metro, pos, edgelist=metro_edges_m2, edge_color="blue", width=1.5, alpha=0.7)
nx.draw_networkx_edges(G_metro, pos, edgelist=metro_edges_m3, edge_color="green", width=1.5, alpha=0.7)
nx.draw_networkx_edges(G_metro, pos, edgelist=electric_edges, edge_color="orange", width=1.5, alpha=0.7)
nx.draw_networkx_edges(G_metro, pos, edgelist=metro_transfers, edge_color="black", width=1.5, alpha=0.7)
nx.draw_networkx_edges(G_metro, pos, edgelist=metro_to_electric_transfers, edge_color="black", width=1.5, alpha=0.7)

# Малюємо вершини (станції)
nx.draw_networkx_nodes(G_metro, pos, node_size=200, node_color="lightgray", alpha=0.9)

# Підписи станцій
nx.draw_networkx_labels(G_metro, pos, font_size=8, font_family="sans-serif")

# Підписи для ваг на ребрах
labels = nx.get_edge_attributes(G_metro, "weight")
nx.draw_networkx_edge_labels(G_metro, pos, edge_labels=labels, font_size=8)

plt.title("Київський метрополітен та міська електричка", fontsize=15)
plt.show()

if __name__ == "__main__":
    # Аналіз основних характеристик
    num_vertices = G_metro.number_of_nodes()
    num_edges = G_metro.number_of_edges()
    degree_of_vertices = dict(G_metro.degree())

    print(f"Кількість вершин: {num_vertices}")
    print(f"Кількість ребер: {num_edges}")
    print(f"Ступінь вершин: {degree_of_vertices}")